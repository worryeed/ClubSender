"""–ú–æ–¥—É–ª—å —Å —Ä—É—Å—Å–∫–∏–º–∏ –ø–µ—Ä–µ–≤–æ–¥–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è XPoker GUI."""

from typing import Dict, Any

# –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã
class Icons:
    SUCCESS = "‚úÖ"       # –£—Å–ø–µ—Ö
    ERROR = "‚ùå"         # –û—à–∏–±–∫–∞
    WARNING = "‚ö†Ô∏è"      # –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ
    INFO = "‚ÑπÔ∏è"         # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    PROCESS = "üîÑ"      # –ü—Ä–æ—Ü–µ—Å—Å –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è
    NETWORK = "üåê"      # –°–µ—Ç–µ–≤—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
    AUTH = "üîê"         # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    CLUB = "üèõÔ∏è"        # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–ª—É–±–∞–º–∏
    TCP = "üîå"          # TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    TARGET = "üéØ"       # –¶–µ–ª–µ–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
    CELEBRATION = "üéâ"  # –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

# –ü–µ—Ä–µ–≤–æ–¥—ã —Å—Ç–∞—Ç—É—Å–æ–≤ –∫–ª—É–±–æ–≤
CLUB_STATUS_MESSAGES = {
    0: "–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞",
    1: "–û–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è",
    2: "–£–∂–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –∫–ª—É–±–µ", 
    3: "–ö–ª—É–± –∑–∞–ø–æ–ª–Ω–µ–Ω",
    4: "–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞",
    5: "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –∫–ª—É–±–µ",
    -1: "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å",
    "unknown": "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å",
    "club_not_found": "‚ùå –ö–ª—É–±–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
    "invalid_club_id": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π ID –∫–ª—É–±–∞",
    "network_error": "‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏"
}

# –ü–µ—Ä–µ–≤–æ–¥—ã –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
MESSAGES = {
    # –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
    "login_start": "üîê –ù–∞—á–∏–Ω–∞–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é",
    "login_success": "‚úÖ –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞",
    "login_failed": "‚ùå –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏",
    "login_no_token": "‚ö†Ô∏è –¢–æ–∫–µ–Ω –Ω–µ –ø–æ–ª—É—á–µ–Ω",
    "login_uid_found": "‚ÑπÔ∏è UID –ø–æ–ª—É—á–µ–Ω",
    "login_uid_missing": "‚ö†Ô∏è UID –Ω–µ –Ω–∞–π–¥–µ–Ω",
    
    # TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
    "tcp_connect_start": "üîå –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ",
    "tcp_connect_success": "‚úÖ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ",
    "tcp_connect_failed": "‚ùå –û—à–∏–±–∫–∞ TCP —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è",
    "tcp_auth_start": "üîê TCP –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è",
    "tcp_auth_success": "‚úÖ TCP –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞",
    "tcp_auth_failed": "‚ùå –û—à–∏–±–∫–∞ TCP –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏",
    
    # –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –∫–ª—É–±–∞–º–∏
    "club_desc_start": "üèõÔ∏è –ü–æ–ª—É—á–∞–µ–º –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª—É–±–∞",
    "club_desc_success": "‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª—É–±–∞ –ø–æ–ª—É—á–µ–Ω–æ",
    "club_desc_failed": "‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ–ø–∏—Å–∞–Ω–∏–µ –∫–ª—É–±–∞",
    "club_apply_start": "üéØ –ü–æ–¥–∞–µ–º –∑–∞—è–≤–∫—É –≤ –∫–ª—É–±",
    "club_apply_success": "üéâ –£—Å–ø–µ—à–Ω–æ –≤—Å—Ç—É–ø–∏–ª–∏ –≤ –∫–ª—É–±",
    "club_apply_failed": "‚ùå –ó–∞—è–≤–∫–∞ –≤ –∫–ª—É–± –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞",
    "club_already_member": "‚ÑπÔ∏è –£–∂–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –∫–ª—É–±–µ",
    "club_not_found": "‚ùå –ö–ª—É–± –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
    
    # –û–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è
    "process_interrupted": "‚ö†Ô∏è –ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–µ—Ä–≤–∞–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º",
    "unknown_error": "‚ùå –ù–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è –æ—à–∏–±–∫–∞",
    "invalid_club_id": "‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç ID –∫–ª—É–±–∞"
}

def get_club_status_message(status_code: int, club_exists: bool = True, club_id: str = "") -> str:
    """
    –ü–æ–ª—É—á–∏—Ç—å —Ä—É—Å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è —Å—Ç–∞—Ç—É—Å–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ –∫–ª—É–±.
    
    Args:
        status_code: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞
        club_exists: –°—É—â–µ—Å—Ç–≤—É–µ—Ç –ª–∏ –∫–ª—É–±
        club_id: ID –∫–ª—É–±–∞ (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–µ)
        
    Returns:
        –†—É—Å—Å–∫–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º
    """
    # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—É–±–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å—É
    if not club_exists or status_code == -1 or status_code == 1002:
        return CLUB_STATUS_MESSAGES["club_not_found"]
    
    return CLUB_STATUS_MESSAGES.get(status_code, CLUB_STATUS_MESSAGES["unknown"])

def format_join_result(username: str, club_id: str, success: bool, message: str) -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–ª—É–±–∞ —Å –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–∞–º–∏.
    
    –ú—ã –Ω–µ —É—Ç–≤–µ—Ä–∂–¥–∞–µ–º –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —É–ø—Ä–æ—â—ë–Ω–Ω—ã–π —Å—Ç–∞—Ç—É—Å –Ω–∞–ª–∏—á–∏—è –∫–ª—É–±–∞.
    
    Args:
        username: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        club_id: ID –∫–ª—É–±–∞
        success: –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –æ–ø–µ—Ä–∞—Ü–∏–∏ (True = –∫–ª—É–± —Å—É—â–µ—Å—Ç–≤—É–µ—Ç/–¥–æ—Å—Ç—É–ø–µ–Ω)
        message: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ—Ç–º–µ–Ω—ã/–æ—à–∏–±–æ–∫ —Å–µ—Ç–∏)
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    """
    m = (message or "").strip()
    # –û—Ç–¥–µ–ª—å–Ω—ã–π —Å–ª—É—á–∞–π: –æ—Ç–º–µ–Ω–∞
    if not success and ("Cancel" in m or "–û—Ç–º–µ–Ω" in m):
        icon = Icons.WARNING
        text = "–û—Ç–º–µ–Ω–µ–Ω–æ"
        return f"{icon} [{username}] ‚Üí –ö–ª—É–± {club_id}: {text}"
    # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
    icon = Icons.SUCCESS if success else Icons.ERROR
    text = "–ö–ª—É–± –µ—Å—Ç—å" if success else "–ö–ª—É–±–∞ –Ω–µ—Ç"
    return f"{icon} [{username}] ‚Üí –ö–ª—É–± {club_id}: {text}"

def format_tcp_step(step_name: str, success: bool, details: str = "") -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —à–∞–≥–µ TCP –æ–ø–µ—Ä–∞—Ü–∏–∏.
    
    Args:
        step_name: –ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞
        success: –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        details: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    """
    icon = Icons.SUCCESS if success else Icons.ERROR
    msg = f"{icon} {step_name}"
    if details:
        msg += f": {details}"
    return msg

def format_login_step(username: str, step: str, success: bool, details: str = "") -> str:
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ —à–∞–≥–µ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏.
    
    Args:
        username: –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
        step: –ù–∞–∑–≤–∞–Ω–∏–µ —à–∞–≥–∞
        success: –£—Å–ø–µ—à–Ω–æ—Å—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
        details: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏
        
    Returns:
        –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    """
    icon = Icons.SUCCESS if success else Icons.ERROR
    msg = f"{icon} [{username}] {step}"
    if details:
        msg += f": {details}"
    return msg

# –°—Ç–∞—Ç—É—Å—ã –æ—Ç–≤–µ—Ç–æ–≤ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
def decode_club_apply_status(status_code: int) -> Dict[str, Any]:
    """
    –†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å —Å—Ç–∞—Ç—É—Å –æ—Ç–≤–µ—Ç–∞ –Ω–∞ –∑–∞—è–≤–∫—É –≤ –∫–ª—É–±.
    
    Args:
        status_code: –ö–æ–¥ —Å—Ç–∞—Ç—É—Å–∞ (int –∏–ª–∏ str-—á–∏—Å–ª–æ)
        
    Returns:
        –°–ª–æ–≤–∞—Ä—å —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Å—Ç–∞—Ç—É—Å–µ
    """
    status_map = {
        0: {
            "success": True,
            "icon": Icons.CELEBRATION,
            "message": "–ó–∞—è–≤–∫–∞ —É—Å–ø–µ—à–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞",
            "description": "–í—ã —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∞–ª–∏ –∑–∞—è–≤–∫—É –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –∫–ª—É–±"
        },
        1: {
            "success": True, 
            "icon": Icons.INFO,
            "message": "–ó–∞—è–≤–∫–∞ –æ–∂–∏–¥–∞–µ—Ç –æ–¥–æ–±—Ä–µ–Ω–∏—è",
            "description": "–ó–∞—è–≤–∫–∞ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞, –æ–∂–∏–¥–∞–µ—Ç—Å—è —Ä–µ—à–µ–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∫–ª—É–±–∞"
        },
        2: {
            "success": True,
            "icon": Icons.INFO, 
            "message": "–£–∂–µ —Å–æ—Å—Ç–æ–∏—Ç –≤ –∫–ª—É–±–µ",
            "description": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ —è–≤–ª—è–µ—Ç—Å—è —á–ª–µ–Ω–æ–º —ç—Ç–æ–≥–æ –∫–ª—É–±–∞"
        },
        3: {
            "success": False,
            "icon": Icons.WARNING,
            "message": "–ö–ª—É–± –∑–∞–ø–æ–ª–Ω–µ–Ω",
            "description": "–í –∫–ª—É–±–µ –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–æ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤"
        },
        4: {
            "success": False,
            "icon": Icons.ERROR,
            "message": "–ó–∞—è–≤–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞", 
            "description": "–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∫–ª—É–±–∞ –æ—Ç–∫–ª–æ–Ω–∏–ª –∑–∞—è–≤–∫—É –Ω–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ"
        },
        5: {
            "success": False,
            "icon": Icons.ERROR,
            "message": "–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ –∫–ª—É–±–µ",
            "description": "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω –≤ —ç—Ç–æ–º –∫–ª—É–±–µ"
        },
        -1: {
            "success": False,
            "icon": Icons.ERROR,
            "message": "‚ùå –ö–ª—É–±–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç",
            "description": "–£–∫–∞–∑–∞–Ω–Ω—ã–π –∫–ª—É–± –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω"
        },
        # –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ "–∫–ª—É–± –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç"
        1002: {
            "success": False,
            "icon": Icons.ERROR,
            "message": "‚ùå –ö–ª—É–±–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", 
            "description": "–ö–ª—É–± –Ω–µ –Ω–∞–π–¥–µ–Ω –∏–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (—Å—Ç–∞—Ç—É—Å 1002)"
        }
    }
    
    # –ó–∞—â–∏—Ç–∞ –æ—Ç —Å—Ç—Ä–æ–∫–æ–≤–æ–≥–æ –∫–æ–¥–∞ —Å—Ç–∞—Ç—É—Å–∞
    try:
        code = int(status_code)
    except Exception:
        code = status_code
    
    return status_map.get(code, {
        "success": False,
        "icon": Icons.WARNING,
        "message": "‚ùì –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å",
        "description": f"–ü–æ–ª—É—á–µ–Ω –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Å—Ç–∞—Ç—É—Å {status_code}"
    })
